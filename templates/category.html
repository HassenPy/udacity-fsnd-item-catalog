{% extends 'base.html' %}

{% block title %}Home{% endblock %}

{% block content %}
<div class="modal fade" tabindex="-1" role="dialog" id="deleteModal">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h4 class="modal-title">Confirm delete</h4>
      </div>
      <div class="modal-body">
        <p>Are you sure you want to delete this pick?</p>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-cancel" data-dismiss="modal">cancel</button>
        <button type="button" class="btn btn-danger" data-dismiss="modal" id="deleteButton">delete</button>
      </div>
    </div>
  </div>
</div>

<div class="catalog row">
  <div class="categories col-xs-12 col-sm-4 col-sm-offset-0 col-md-3 col-md-offset-1">
    <h3 class="list-header">Communities</h3>
    <ul class="list">
      {% for category_l in categories %}
        {% if category_l.id == category.id %}
          <li class="list-item active">
            <a href="{{ url_for('catalogApp.category_page', id=category_l.id) }}">
              {{ category_l.title }}</a>
          </li>
        {% else %}
          <li class="list-item">
            <a href="{{ url_for('catalogApp.category_page', id=category_l.id) }}">
              {{ category_l.title }}</a>
          </li>
        {% endif %}
      {% endfor %}
    </ul>
  </div>
  <div class="items col-xs-12 col-sm-7 col-md-7">
    <h3 class="list-header col-xs-12">Latest {{ category.title }} community posts</h3>
    <ul class="list col-xs-12">
      {% for item in items['items'] %}
        <li class="list-item pull-left">
          <div class="col-xs-12">
            <a href="{{ item.link }}" target="_blank" rel="nofollow">
              {{ item.title }}</a>
          </div>
          <div class="col-xs-12">
            <span>
              <time class="timeago" datetime="{{item.created}}"></time>
              <span class="author" data-author="/api/user/{{item.author}}/"></span>
            </span>
            {% if current_user.is_authenticated and
              item.author == current_user.id or current_user.admin
            %}
            <span>
              <a href="{{url_for('catalogApp.item_edit', id=item.id)}}">
                <i class="icon-pencil"></i>
              </a>
              <button data-href="/api/item/{{item.id}}/" class="btn-delete delete" role="button"
                 data-toggle="modal" data-target="#deleteModal">
                <i class="icon-trash-empty"></i>
              </button>
            </span>
            {% endif %}
          </div>
        </li>
      {% endfor %}
    </ul>
    <div class="col-xs-12 text-center">
      {% if items.prev_num %}
      <a href="{{url_for('catalogApp.category_page', id=category.id)}}?o={{items.prev_num}}"
         class="load highlight-link">
        previous</a>
      {% endif %}
      {{items.page}}
      {% if items.next_num %}
      <a href="{{url_for('catalogApp.category_page', id=category.id)}}?o={{items.next_num}}"
         class="load highlight-link">
        next</a>
      {% endif %}
    </div>
  </div>
</div>
{% endblock %}

{% block footer_scripts %}
<script src="/static/js/timeago.min.js"></script>
<script src="/static/js/main.js"></script>
{% endblock %}
